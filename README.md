# é’‰é’‰K8sè¿ç»´æœºå™¨äºº

ä¸€ä¸ªåŸºäºé’‰é’‰çš„æ™ºèƒ½Kubernetesè¿ç»´æœºå™¨äººï¼Œæ”¯æŒé€šè¿‡è‡ªç„¶è¯­è¨€è¿›è¡ŒK8sé›†ç¾¤ç®¡ç†å’Œè¿ç»´æ“ä½œã€‚

## âœ¨ æ ¸å¿ƒç‰¹æ€§

- ğŸ¤– **æ™ºèƒ½å¯¹è¯**: è‡ªç„¶è¯­è¨€äº¤äº’ï¼Œç†è§£è¿ç»´æ„å›¾
- âš™ï¸ **K8sç®¡ç†**: Podã€Serviceã€Deploymentç­‰èµ„æºç®¡ç†
- ğŸ“Š **å®æ—¶ç›‘æ§**: é›†ç¾¤çŠ¶æ€ã€èµ„æºä½¿ç”¨æƒ…å†µç›‘æ§
- ğŸ”§ **MCPåè®®**: å¯æ‰©å±•çš„å·¥å…·ç³»ç»Ÿ
- ğŸŒ **Webç•Œé¢**: ç°ä»£åŒ–èŠå¤©ç•Œé¢
- ğŸ“± **é’‰é’‰é›†æˆ**: æœºå™¨äººwebhookæ¨é€
- ğŸ” **å®‰å…¨å¯æ§**: æƒé™æ§åˆ¶å’Œæ“ä½œå®¡è®¡
- ğŸ’¾ **ä¼šè¯æŒä¹…åŒ–**: å¯¹è¯å†å²è‡ªåŠ¨ä¿å­˜ï¼Œåˆ·æ–°ä¸ä¸¢å¤±
- âš¡ **æµå¼å“åº”**: ä¼˜åŒ–çš„SSEæ ¼å¼ï¼Œå®æ—¶å“åº”ä½“éªŒ

## ğŸš€ æœ€æ–°åŠŸèƒ½

### ä¼šè¯æŒä¹…åŒ–ç³»ç»Ÿ (v0.9.0) â­ æœ€æ–°æ›´æ–°
- âœ… **è‡ªåŠ¨æ•°æ®æ¢å¤** - åˆ·æ–°é¡µé¢åå¯¹è¯å†å²å®Œæ•´ä¿ç•™
- âœ… **æ™ºèƒ½ä¼šè¯ç®¡ç†** - å¤šä¼šè¯æ”¯æŒï¼Œå†å²è®°å½•æœç´¢
- âœ… **æ•°æ®å®Œæ•´æ€§** - è‡ªåŠ¨ä¿®å¤å’ŒéªŒè¯æœºåˆ¶
- âœ… **å­˜å‚¨ä¼˜åŒ–** - æ¸è¿›å¼åŠ è½½ï¼Œå¤§æ•°æ®é›†æ”¯æŒ

### æµå¼å“åº”ä¼˜åŒ– (v0.8.0)
- âœ… **ä¼˜åŒ–SSEæ ¼å¼** - æ”¹è¿›åˆ†éš”ç¬¦ï¼Œæå‡å“åº”é€Ÿåº¦
- âœ… **æ™ºèƒ½é”™è¯¯å¤„ç†** - 11ç§é”™è¯¯ç±»å‹åˆ†ç±»å’Œå»ºè®®
- âœ… **å®æ—¶ç›‘æ§** - æ€§èƒ½ç»Ÿè®¡å’Œè°ƒè¯•ç«¯ç‚¹
- âœ… **å¥å£®è¿æ¥** - è‡ªåŠ¨é‡è¿å’ŒçŠ¶æ€ç®¡ç†

### MCPå·¥å…·ç³»ç»Ÿ
- âœ… **K8s-MCPæœåŠ¡å™¨** - 8ä¸ªå®Œæ•´çš„K8sç®¡ç†å·¥å…·
- âœ… **å·¥å…·è·¯ç”±** - æ™ºèƒ½è·¯ç”±å’Œè´Ÿè½½å‡è¡¡
- âœ… **åŠ¨æ€é…ç½®** - çƒ­é‡è½½å’Œè¿è¡Œæ—¶æ›´æ–°

## ğŸ¯ é¡¹ç›®è¿›åº¦

**å½“å‰å®Œæˆåº¦: 80%** ğŸ‰

- âœ… **åŸºç¡€æ¶æ„** (95%) - å‰åç«¯åˆ†ç¦»æ¶æ„å®Œæˆ
- âœ… **MCPå·¥å…·é›†æˆ** (90%) - K8så·¥å…·å®Œæ•´å®ç°
- âœ… **æµå¼å¯¹è¯** (90%) - å®æ—¶èŠå¤©å’Œå·¥å…·è°ƒç”¨
- âœ… **ä¼šè¯ç®¡ç†** (85%) - æŒä¹…åŒ–å’Œå†å²ç®¡ç†
- ğŸ”„ **MCPè¿æ¥** (80%) - æœ€åé…ç½®é—®é¢˜ä¿®å¤ä¸­

## æ¶æ„è®¾è®¡

![project_document/architechture-diagrams/arch.png]

## å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡ï¼ˆ30ç§’å¯åŠ¨ï¼‰

> ğŸ“‹ **é¡¹ç›®ç®¡ç†**: æœ¬é¡¹ç›®ä½¿ç”¨ [Poetry](https://python-poetry.org/) è¿›è¡ŒPythonä¾èµ–ç®¡ç†ï¼Œæ‰€æœ‰Pythonå‘½ä»¤å¿…é¡»ä½¿ç”¨ `poetry run` å‰ç¼€

```bash
# å…‹éš†é¡¹ç›®
git clone <repository-url>
cd ding-robot

# å®‰è£…Poetryä¾èµ–
poetry install

### 2. é…ç½®æ–‡ä»¶

ç¼–è¾‘ `backend/config.env` æ–‡ä»¶ï¼š

```env
# LLMé…ç½®
OPENAI_API_KEY=your_openai_api_key_here
LLM_MODEL=gpt-3.5-turbo

# Kubernetesé…ç½®
KUBECONFIG_PATH=/path/to/kubeconfig
K8S_NAMESPACE=default

# MCPé…ç½® (é‡è¦: ä½¿ç”¨localhostè€Œä¸æ˜¯ç¯å¢ƒå˜é‡)
K8S_MCP_HOST=localhost
K8S_MCP_PORT=8766

# é’‰é’‰é…ç½®
DINGTALK_WEBHOOK_URL=https://oapi.dingtalk.com/robot/send?access_token=your_token
DINGTALK_SECRET=your_secret
```

### 3. å¯åŠ¨MCPå·¥å…·æœåŠ¡å™¨

```bash
# å¯åŠ¨K8s MCPæœåŠ¡å™¨
cd k8s-mcp
poetry run python -m k8s_mcp.server

# SSH-Jumpserver MCP (å¼€å‘ä¸­ï¼Œæš‚ä¸å¯ç”¨)
# cd ssh-jumpserver-mcp
# poetry run python -m ssh_jumpserver_mcp.server
```

### 4. å¯åŠ¨ä¸»æœåŠ¡

```bash
# å¼€å‘ç¯å¢ƒï¼ˆå‰åç«¯åˆ†ç¦»ï¼‰
poetry run dev

# ç”Ÿäº§ç¯å¢ƒï¼ˆå•ç«¯å£é›†æˆï¼‰
poetry run build && poetry run serve
```

### 5. è®¿é—®åº”ç”¨

**å¼€å‘ç¯å¢ƒ**:
- ğŸŒ å‰ç«¯: http://localhost:3000 (çƒ­é‡è½½)
- ğŸ”§ åç«¯: http://localhost:8000
- ğŸ“š APIæ–‡æ¡£: http://localhost:8000/docs

**ç”Ÿäº§ç¯å¢ƒ**:
- ğŸŒ ä¸»é¡µ: http://localhost:8000
- ğŸ“± SPAåº”ç”¨: http://localhost:8000/spa/
- ğŸ“š APIæ–‡æ¡£: http://localhost:8000/docs

## ğŸ“š è¯¦ç»†æ–‡æ¡£

```
project_document/
```

## ğŸ› ï¸ æ”¯æŒçš„å·¥å…·

### Kuberneteså·¥å…· (8ä¸ª)
- `k8s-get-pods` - è·å–Podåˆ—è¡¨å’ŒçŠ¶æ€
- `k8s-get-services` - è·å–Serviceåˆ—è¡¨  
- `k8s-get-deployments` - è·å–Deploymentåˆ—è¡¨
- `k8s-get-nodes` - è·å–NodeèŠ‚ç‚¹ä¿¡æ¯
- `k8s-scale-deployment` - æ‰©ç¼©å®¹Deployment
- `k8s-get-logs` - è·å–Podæ—¥å¿—
- `k8s-describe-pod` - è·å–Podè¯¦ç»†ä¿¡æ¯
- `k8s-get-events` - è·å–é›†ç¾¤äº‹ä»¶

### SSHå·¥å…·é›† (è®¡åˆ’ä¸­)
- `ssh-execute` - è¿œç¨‹å‘½ä»¤æ‰§è¡Œ (å¼€å‘ä¸­)
- `ssh-asset-list` - æœåŠ¡å™¨èµ„äº§ç®¡ç† (è§„åˆ’ä¸­)
- `ssh-session-manager` - SSHä¼šè¯ç®¡ç† (è§„åˆ’ä¸­)

## âš¡ å¯ç”¨å‘½ä»¤

| å‘½ä»¤ | åŠŸèƒ½ | ä½¿ç”¨åœºæ™¯ |
|------|------|----------|
| `poetry run dev` | å¯åŠ¨å¼€å‘ç¯å¢ƒ | æ—¥å¸¸å¼€å‘ |
| `poetry run build` | æ„å»ºé¡¹ç›® | éƒ¨ç½²å‰å‡†å¤‡ |
| `poetry run serve` | å¯åŠ¨ç”Ÿäº§æœåŠ¡ | ç”Ÿäº§éƒ¨ç½² |
| `poetry run setup` | é¡¹ç›®åˆå§‹åŒ– | ç¬¬ä¸€æ¬¡è®¾ç½® |

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **MCPè¿æ¥å¤±è´¥** 
   ```bash
   # æ£€æŸ¥é…ç½®æ–‡ä»¶ backend/config/mcp_config.json
   # ç¡®ä¿ "host": "localhost" è€Œä¸æ˜¯ "${K8S_MCP_HOST}"
   ```

2. **ä¼šè¯æ•°æ®ä¸¢å¤±**
   ```bash
   # å·²ä¿®å¤ï¼šç°åœ¨æ”¯æŒè‡ªåŠ¨æ•°æ®æ¢å¤
   # åˆ·æ–°é¡µé¢åå¯¹è¯å†å²å®Œæ•´ä¿ç•™
   ```

3. **æµå¼å“åº”å¼‚å¸¸**
   ```bash
   # å·²ä¿®å¤ï¼šä¼˜åŒ–äº†SSEæ ¼å¼
   # æ”¯æŒæ›´å¿«çš„å®æ—¶å“åº”
   ```

### ç›‘æ§ç«¯ç‚¹
- **å¥åº·æ£€æŸ¥**: `GET /api/v2/health`
- **æ€§èƒ½ç»Ÿè®¡**: `GET /api/v2/debug/performance`
- **ç³»ç»ŸçŠ¶æ€**: `GET /api/status`
- **å¯ç”¨å·¥å…·**: `GET /api/v2/tools`

## ğŸ¯ ä¸‹ä¸€æ­¥è®¡åˆ’

### å³å°†å‘å¸ƒ (v1.0.0)
- âœ… MCPè¿æ¥é…ç½®ä¿®å¤
- âœ… ç”Ÿäº§éƒ¨ç½²ä¼˜åŒ–
- âœ… ç›‘æ§å’Œå‘Šè­¦ç³»ç»Ÿ
- âœ… ç”¨æˆ·æƒé™ç®¡ç†

### æœªæ¥åŠŸèƒ½
- ğŸ”§ **SSH-Jumpserver MCP** - ä¼ä¸šçº§SSHè¿ç»´å·¥å…·é›†
  - SSHå‘½ä»¤æ‰§è¡Œå’Œä¼šè¯ç®¡ç†
  - JumpServerå¹³å°é›†æˆ
  - æœåŠ¡å™¨èµ„äº§ç®¡ç†
  - å®‰å…¨å®¡è®¡å’Œæƒé™æ§åˆ¶
- ğŸ“Š å¯è§†åŒ–è¿ç»´é¢æ¿
- ğŸ”„ æ‰¹é‡æ“ä½œæ”¯æŒ
- ğŸ“± ç§»åŠ¨ç«¯é€‚é…
- ğŸ¤– æ›´å¤šAIå·¥å…·é›†æˆ

## ğŸ“„ è®¸å¯è¯

MIT License

---

**ğŸ‰ é¡¹ç›®å·²æ¥è¿‘å®Œæˆï¼ç›®å‰85%åŠŸèƒ½å°±ç»ªï¼ŒæœŸå¾…ä½ çš„ä½“éªŒå’Œåé¦ˆï¼**